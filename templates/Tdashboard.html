{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html>
<head>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="{% static 'home.css' %}">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<!-- <script>
window.onload = function () {
console.log("chart");
var chart = new CanvasJS.Chart("chartContainer", {
	exportEnabled: true,
	animationEnabled: true,
	title:{
		text: "Your Activity"
	},
	legend:{
		cursor: "pointer",
		itemclick: explodePie
	},
	data: [{
		type: "pie",
		showInLegend: true,
		toolTipContent: "{name}: <strong>{y}%</strong>",
		indexLabel: "{name} - {y}%",
		dataPoints: [
			{ y: 26, name: "School Aid", exploded: true },
			{ y: 20, name: "Medical Aid" },
			{ y: 5, name: "Debt/Capital" },
			{ y: 3, name: "Elected Officials" },
			{ y: 7, name: "University" },
			{ y: 17, name: "Executive" },
			{ y: 22, name: "Other Local Assistance"}
		]
	}]
});
chart.render();
}

function explodePie (e) {
	if(typeof (e.dataSeries.dataPoints[e.dataPointIndex].exploded) === "undefined" || !e.dataSeries.dataPoints[e.dataPointIndex].exploded) {
		e.dataSeries.dataPoints[e.dataPointIndex].exploded = true;
	} else {
		e.dataSeries.dataPoints[e.dataPointIndex].exploded = false;
	}
	e.chart.render();

}
</script> -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
<script src="https://kit.fontawesome.com/64d58efce2.js" crossorigin="anonymous"></script>
<script src="{% static 'Tdb.js' %}"></script>
  </head>
<body>
    <div id='main'>
      <!-- Dashboard navigation bar -->
 <nav class="navbar navbar-expand-lg navbar-dark " style="background-color:#026670;">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="logo" href="/home">
      <div class="logo">
            <img style="size:small"src="{% static 'logo.png' %}" width="100" >
      </div>
     </a>
    <a class="navbar-brand" href="">Hi {{det.userName}}!</a>
  
    <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
        <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
          
            <li class="nav-item">
        <button class="openbtn" onclick="openNav()">&#9776;</button>
            </li>
        <!-- <li class="nav-item ">
          <a class="nav-link" href="#">icon <span class="sr-only">(current)</span></a>
        </li> -->
        <li class="nav-item">
          <a class="nav-link" href="/home">Home <i class="fa fa-home fa-lg"></i></a>
        </li>
        <li class="nav-item">
            
            <a class="nav-link" href="/dashboard/settings">Update Profile <i class="fa fa-user-cog fa-lg"></i></a>
            
          </li>
          
         
          <li class="nav-item"  style="float: right;">
            {% if det.profilepic %}
            <img class="profile" src="{{det.profilepic.url}}" style="width: 60px;height: 60px;border-radius: 50%;float: right;">
            {% endif %}
            
          </li>
          <li class="nav-item" style="float: right;" >
            <a class="nav-link" href="/logout">Logout <i class="fa fa-sign-out-alt fa-lg"></i></a>
          </li>
       </ul>
    </div>
</nav>
<!--components of page-->
<div class="flex-container">

    <div  style="background-color: white;"> 

      <div id="myChartBar" style="height: 370px; width: 100%;"></div>
          </div>
             <div class="extrainfo" style="flex-grow: 2; background-color:#FEF9C7; color:black;">
            <h3 style="color:#026670;">No. of Questions Answered : {{det.ansNo}}</h3>
            <h3 style="color:#026670;">Average Rating :</h3>
            <h3 style="color:#026670;">Current Badge:</h3>
          </div>
        
      </div>
      <div class="flex-container">


      
        <div class="list-group" id="recent" style="flex-grow: 5; background-color: #edeae5;"> <h3 style="color:#026670;">Recent Questions Answered </h3>
            
               
                  {% for i in que2 %}
                  <a href="solution/{{i.id}}" class="list-group-item list-group-item-action">
                  <div class="d-flex w-100 justify-content-between">
                    
                    <h5 class="mb-1">{{i.quesText}}</h5>
                    <small>{{i.time|naturaltime}} 
                      Rating :
                      {{i.rating}}</small>
                  </div>
                  <p class="mb-1">posted by: {{i.postedBy}}</p>
                  <a class="ans" href="/solution/{{i.id}}">See  answer</a> 
                </a>
                {% endfor %}
              </div>
            </div><br><br>
          
          <section>
          <div id="notify">
              <h4><i class="fa fa-bell"></i> Notifications!</h4>
              {% for i in que %}
              {% if i.accepted == False %}
              {% if i.expired == False %}
            <div class="alert alert-primary" role="alert">
                <h5>{{i.topic}}</h5>
                <br>
                <h6>{{i.quesText}}</h6>
            </div>
              <div class="btn-group" role="group" aria-label="Basic example">
                <!-- <button type="submit" class="btn  my-3" ><a href="dashboard/save/{{i.id}}" ><b>Accept and save</a></b></button> -->
                <button type="submit" class="btn  my-3 saveques" data-answer="{{i.id}}"><b>Accept and save</b></button>
                <button type="button" class="btn  my-3" onclick="accAns()" ><a href="dashboard/answer/{{i.id}}"><b>Accept and Answer</a></b></button> 
              </div>
            
               <br>
               {% endif %}
              {% endif %}
              {% endfor %}
               <br>             
          </div>   
        </section>  
        <hr>  
            
          <div id='current' class='current'>
            {% for i in que %}
            {% if i.id == workOn %}
            <div>
            <h4> <i class="fa fa-tools"></i> Working on:</h4> <h5> {{ i.quesText }}</h5>
            
            <button class="working" style="margin: 10px;" ><a href="dashboard/Answer/{{workOn}}">Answer</a></button>
            </div>
            {% endif %}
            {% endfor %}
            </div>
            

            <hr>
            <div id="expired" >
              <h4><i class="fa fa-info"></i> Expired questions</h4>
              {% for i in que %}
              {% if i.acceptedBy == request.user.username %}
               {% if i.expired == True %}
                
                  <div class="d-flex w-100 justify-content-between">
                    
                    <h5 class="mb-1">{{i.quesText}}</h5>
                    <small>1 day ago</small>
                  </div>
                  <p class="mb-1">posted by: {{i.postedBy}}</p>
                  {% endif %}
                {% endif %}
                {% endfor %}
            </div>

<!--Dashboard sidebar-->
<div id="mySidebar" class="sidebar">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a href="#recent topics">Topics  <i style='font-size:24px' class='far'>&#xf24d;</i></a>
    <a href="#notify">Notifications <i style="font-size:24px" class="fa">&#xf0f3;</i></a>
    <a href="#recent">Recent Activity  <i class="material-icons">&#xe0c9;</i></a>
    <a href="#expired">Expired</a>
    <a href="#current">Current</a>
  </div>
</div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  <script>
  var endpoint = '/api'; 
  
    $.ajax({ 
      method: "GET", 
      url: endpoint, 
      success: function(data) { 
        
        drawBarGraph(data, 'myChartBar'); 
        console.log("drawing"); 
      }, 
      error: function(error_data) { 
        console.log(error_data); 
      } 
    }) 
  
  
    
  
    function drawBarGraph(data, id) { 
      var labels = data.labels; 
      var chartLabel = data.chartLabel; 
      var chartdata = data.chartdata; 
      var ctx = document.getElementById(id).getContext('2d'); 
      var myChart = new Chart(ctx, { 
        type: 'pie', 
        data: { 
          labels: labels, 
          datasets: [{ 
            label: chartLabel, 
            data: chartdata, 
            backgroundColor: [ 
              'rgba(255, 99, 132, 0.7)', 
              'rgba(54, 162, 235, 0.7)', 
              'rgba(255, 206, 86, 0.7)', 
              'rgba(75, 192, 192, 0.7)', 
              'rgba(153, 102, 255, 0.7)', 
              'rgba(255, 159, 64, 0.7)' 
            ], 
            borderColor: [ 
              'rgba(255, 99, 132, 1)', 
              'rgba(54, 162, 235, 1)', 
              'rgba(255, 206, 86, 1)', 
              'rgba(75, 192, 192, 1)', 
              'rgba(153, 102, 255, 1)', 
              'rgba(255, 159, 64, 1)' 
            ], 
            borderWidth: 1 
          }] 
        }, 
        options: { 
          scales: { 
            yAxes: [{ 
              ticks: { 
                beginAtZero: true 
              } 
            }] 
          } 
        } 
      }); 
    } 
  </script>

    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    </body>
</html>